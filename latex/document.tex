\documentclass[UKenglish,10pt,a4paper]{report}
\setlength\textwidth{145mm}
\setlength\textheight{247mm}
\setlength\oddsidemargin{5mm}
\setlength\evensidemargin{15mm}
\setlength\topmargin{0mm}
\setlength\headsep{0mm}
\setlength\headheight{0mm}
% \openright zařídí, aby následující text začínal na pravé straně knihy
\let\openright=\clearpage
\renewcommand{\baselinestretch}{1.0}%řádkování
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{tabu}
\usepackage[hyphens]{url}
\usepackage{color}
\usepackage{listings}
\usepackage[utf8]{inputenc}
\usepackage{csquotes}
\usepackage[backend=biber]{biblatex}
\usepackage[pdftex]{graphicx}
\usepackage{epstopdf}
\usepackage{wrapfig}
\usepackage[section]{placeins}
\usepackage{amsfonts}
\usepackage{subcaption}
\usepackage{chronosys}
\usepackage{textcomp}
\usepackage{framed}
\usepackage{float}
\usepackage[czech, UKenglish]{babel}
\usepackage{multicol}
\usepackage{breakurl}
\usepackage[left]{eurosym}
\usepackage[binary-units]{siunitx}
\usepackage{makecell}
\usepackage{isodate}





\newcommand\ytl[2]{
\parbox[b]{8em}{\hfill{\color{cyan}\bfseries\sffamily #1}~$\cdots\cdots$~}\makebox[0pt][c]{$\bullet$}\vrule\quad \parbox[c]{7.5cm}{\vspace{7pt}\color{red!40!black!80}\raggedright\sffamily #2\\[7pt]}\\[-3pt]}

\usepackage[T1]{fontenc}
\usepackage{amsmath}
%\usepackage[toc,page]{appendix}
\usepackage[acronym,toc]{glossaries} 

\usepackage[unicode,breaklinks]{hyperref}  % Musí být za všemi ostatními balíčky
\usepackage{bookmark}




%\usepackage{pdfpages}

\addbibresource{ref.bib}


%% Pokud tiskneme oboustranně:
% \documentclass[12pt,a4paper,twoside,openright]{report}
% \setlength\textwidth{145mm}
% \setlength\textheight{247mm}
% \setlength\oddsidemargin{15mm}
% \setlength\evensidemargin{0mm}
% \setlength\topmargin{0mm}
% \setlength\headsep{0mm}
% \setlength\headheight{0mm}
% \let\openright=\cleardoublepage

%% Pokud používáte csLaTeX (doporučeno):
%\usepackage[czech]{babel}
%% Pokud nikoliv:

\begingroup
    \makeatletter
    \catcode`\-=\active
    \AtBeginDocument{
    \def\@@@cmidrule[#1-#2]#3#4{\global\@cmidla#1\relax
        \global\advance\@cmidla\m@ne
        \ifnum\@cmidla>0\global\let\@gtempa\@cmidrulea\else
        \global\let\@gtempa\@cmidruleb\fi
        \global\@cmidlb#2\relax
        \global\advance\@cmidlb-\@cmidla
        \global\@thisrulewidth=#3
        \@setrulekerning{#4}
        \ifnum\@lastruleclass=\z@\vskip \aboverulesep\fi
        \ifnum0=`{\fi}\@gtempa
        \noalign{\ifnum0=`}\fi\futurenonspacelet\@tempa\@xcmidrule}
    }
\endgroup


%% Použité kódování znaků: obvykle latin2, cp1250 nebo utf8:
%\usepackage[cp1250]{inputenc}

%\usepackage[T1]{fontenc} %tohle by mělo udělat Times New Roman 
%% Ostatní balíčky

%\usepackage{mathtools}
%\usepackage{amsthm}

%% Balíček hyperref, kterým jdou vyrábět klikací odkazy v PDF,
%% ale hlavně ho používáme k uložení metadat do PDF (včetně obsahu).
%% POZOR, nezapomeňte vyplnit jméno práce a autora.
\hypersetup{pdftitle=Optical communications}
\hypersetup{pdfauthor=Bc. et Bc. Jaroslav Svoboda, pdfkeywords={optical,network}}
%\hypersetup{hyperfootnotes=true}
\makeglossaries
%%% Drobné úpravy stylu

% Tato makra přesvědčují mírně ošklivým trikem LaTeX, aby hlavičky kapitol
% sázel příčetněji a nevynechával nad nimi spoustu místa. Směle ignorujte.
\makeatletter
\def\@makechapterhead#1{
  {\parindent \z@ \raggedright \normalfont
   \Huge\bfseries \thechapter. #1
   \par\nobreak
   \vskip 20\p@
}}
\def\@makeschapterhead#1{
  {\parindent \z@ \raggedright \normalfont
   \Huge\bfseries #1
   \par\nobreak
   \vskip 20\p@
}}
\makeatother

% Toto makro definuje kapitolu, která není očíslovaná, ale je uvedena v obsahu.
\def\chapwithtoc#1{
\chapter*{#1}}
\renewcommand{\familydefault}{\rmdefault}
\begin{document}
\selectlanguage{UKenglish}
% Trochu volnější nastavení dělení slov, než je default.
\lefthyphenmin=2
\righthyphenmin=2
\sisetup{range-phrase=--}
%%% Titulní strana práce
\begin{titlepage}


\pagestyle{empty}
\begin{center}

\large

TECHNICAL UNIVERSITY OF MADRID

\medskip

SCHOOL OF TELECOMMUNICATIONS SYSTEMS AND ENGINEERING

\vfill

{\bf\Large Semester Project}

\vfill
\centerline{\mbox{\includegraphics[width=60mm]{img/logo2.eps}\qquad{\includegraphics[width=60mm]{img/logo.eps}}}}
			
\vfill
\vspace{5mm}

{\LARGE Bc. et Bc. Jaroslav Svoboda}

{\LARGE Jaime Sancho}

{\LARGE Diallo Elhadj Sadou}

\vspace{10mm}

% Název práce přesně podle zadání
{\LARGE\bfseries } Smart Lighting

\vfill

% Název katedry nebo ústavu, kde byla práce oficiálně zadána
% (dle Organizační struktury MFF UK)
UBIQUITOUS AND SECURE NETWORKS AND SERVICES

\vfill

\begin{tabular}{rl}

Lecturer: & Jesus Rodriguez Molina  \\
\noalign{\vspace{2mm}}
Subject coordinator: & Jose Fernan Martinez Ortega \\
\noalign{\vspace{2mm}}
Degree programme: & Master in Systems and Services Engineering for the Information society \\
\end{tabular}

\vfill

% Zde doplňte rok
Madrid 2018

\end{center}
\end{titlepage}
\newpage

%%% Následuje vevázaný list -- kopie podepsaného "Zadání bakalářské práce".
%%% Toto zadání NENÍ součástí elektronické verze práce, nescanovat.


\openright

\noindent



%%% Strana s automaticky generovaným obsahem bakalářské práce. U matematických
%%% prací je přípustné, aby seznam tabulek a zkratek, existují-li, byl umístěn
%%% na začátku práce, místo na jejím konci.



\openright
\pagestyle{plain}
\setcounter{page}{1}
\tableofcontents

\newacronym{hps}{HPS}{High-Pressure Sodium}

\chapter{Introduction and Executive Summary}
\section{Introduction}
Smart or intelligent lighting is part of the recent IoT and Smart Cities trend. It is being installed in many cities of developed world improving the safety and efficiency of cities and expanding the services provided to citizens by cities. Our project demonstrates simple system of smart lighting which reacts to movement. 
\section{Benefits of smart lighting}
Main benefits are:
\begin{itemize}
	\item Improved Service
	\item Improved Safety
	\item Energy Savings
	\item Reduced light pollution
\end{itemize}
New installations of smart lighting system in wast majority of cases makes use of LED lights which have improved lifetime period. This lowers costs of lightbulbs and also workforce needed for bulb replacements.

Because the lights dim or turn off, they reduce the needed energy saving costs and environment. This with better light design helps to lower light pollution which is a waste of energy and also has negative impact on fauna. More progress in this are can be achieved by regulation to prevent unnecessary lighting and smart planing of street lighting. 

In areas with low quality or reliability of lighting can newly installed lighting system lower the crime level especially when used with camera system.  
\section{Existing implementations}
\subsection{Chicago}
In the largest city of Midwest lives approximately 2.7 million people on area of \SI{606}{\square\kilo\meter}. This area has $353000$ of outdoor lighting fixtures which in \SI{92}{\percent} of cases use \gls{hps} bulbs. Majority of light poles were installed in 1950's and 60's. City of Chicago decided to renovate its lighting system in fall 2017. Project goal is to replace $270000$ of existing \gls{hps} light fixtures with new energy-efficient LED lights which are now installed in only \SI{2}{\percent} of all street lights. City will be also able to use new lighting management system enabling real-time monitoring, control of the fixtures and in future support smart city applications. This will help to save \SI{50}{\percent} of the city's lighting electric bill, that is approximately \EUR{8.5} million every year. In terms of saved energy, the estimation is \SI{181679358}{\kilo\watt\hour}. City also hopes to lower the use of 311 line. The project should finish in 2021 and use at least \SI{50}{\percent} of local workforce. The program is part of Better Building Initiative which aim is to convert 1.5 million of outdoor lights nation-wide.
\cite{chicago,chicago2}
\subsection{Amsterdam}
In 2012 cities of Amsterdam, Rotterdam and Eindhoven decided to create a trial of Smart Lights in Metropolitan Areas project. Amsterdam decided to create safe and pleasant living and operating environment for newly renovated square Hoekenrodeplein in Amsterdam's Zuidoost district. The city collaborated with Cisco, A2, Phillips, Alliander and KPN. Installed system combines adaptive lighting, cameras and public Wi-Fi. Each of 144 LED lights has its own IP address and can be controlled individually or automatically adapt thanks to sensors. The lights can not only change intensity but also change their colour. The saved energy is used for Wi-Fi network and air quality measuring.\cite{amsterdam, amsterdam2}
\subsection{Project Implementation}
For the project implementation we are using Sun SPOT JAVA Development Kit with 4 motes. Mote characteristics are:
\begin{itemize}
\item \SI{2.4}{\giga\hertz} IEEE 802.15.4 radio with an integrated antenna and a USB interface
\item ARM architecture \SI{32}{\bit} CPU with ARM920T@\SI{180}{\mega\hertz}, \SI{512}{\kilo\byte} RAM and \SI{4}{\mega\byte} flash memory.
\item mote board includes a three-axis accelerometer, temperature sensor, light sensor, 8 tricolor LEDs, analogue and digital inputs, two momentary switches, and 4 high current output pins.
\item unit uses \SI{3.7}{\volt} rechargeable \SI{750}{\milli\ampere\hour} lithium-ion battery, has \SI{30}{\micro\ampere} deep sleep mode and battery management is provided by software.
\end{itemize}
The software was developed on virtual machines running Ubuntu 10.04, Solarium simulation environment and Eclipse IDE.
\chapter{Scheduling of workload}

\chapter{Requirement Analysis}
\section{General use}
\begin{figure}[ht]
	\caption{General use}
	\label{fig:general_use}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.48\textwidth]{{"./img/Drawio/Use Cases/General use case diagram"}.png}
\end{figure}

\begin{table}[!ht]
	\centering
	\caption{General use}
	\label{tab:general_use}
	\begin{tabu}{|l|X[l]|}
		\hline
		Scope and Objectives & \noindent\parbox[c]{\hsize}{The lights on the lampposts switch on/off depending on the information of the movement and light sensor of the motes (if the light is low and the movement sensor detects something, the lights turn on, otherwise they turn off). The data collection centre receives periodically this data and it is capable to change some parameters or request some information of the motes.} \\ \hline
		Actors               & \noindent\parbox[c]{\hsize}{\begin{itemize}
								\item Pedestrians/vehicles
								\item Data control department of the city
								\end{itemize} } \\ \hline
		Preconditions        & \noindent\parbox[c]{\hsize}{\begin{itemize}
								\item The sensor nodes are on
								\item A pedestrian/vehicle comes/goes away from the node
								\end{itemize} }  \\ \hline
		Post-conditions      & \noindent\parbox[c]{\hsize}{ \begin{itemize}
								\item The lights will turn on/off
								\item All the measured information will be sent to the city data manager
								\end{itemize}} \\ \hline
		Sequence Description & \noindent\parbox[c]{\hsize}{\begin{enumerate}
								\item Obtain measurements of movement, temperature, humidity and light.
								\item If there is a change in the movement sensor and the light measured is low, toggle the lights on the node.
								\item Send the status of light to the data control department of the city.
								\end{enumerate}} \\ \hline
		Exceptions           & \noindent\parbox[c]{\hsize}{The node is not able to communicate with the data control department of the city.} \\ \hline
	\end{tabu}

\end{table}

\newpage
\section{Receive Periodic Data}
\begin{figure}[!ht]
	\caption{Receive Periodic Data}
	\label{fig:peridic_data}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Use Cases/Periodically receive data case diagram"}.png}
\end{figure}

\begin{table}[ht]
	\centering
	\caption{Receive Periodic Data}
	\label{tab:periodic_data}
	\begin{tabu}{|l|X[l]|}
		\hline
		Scope and Objectives & \parbox[c]{\hsize}{The motes are placed in the lampposts of the street getting information of the movement and the light. This information added to the LED status of the lamppost is sent to the data collection centre periodically.} \\ \hline
		Actors               & \noindent\parbox[c]{\hsize}{Data control department of the city}      \\ \hline
		Preconditions        & \noindent\parbox[c]{\hsize}{	\begin{itemize}
								\item The sensor nodes are on
								\item The sensor nodes have sufficient memory to store measured values when connection is off
								\end{itemize}}  \\ \hline
		Post-conditions      & \noindent\parbox[c]{\hsize}{\begin{itemize}
								\item The measured value is stored in memory
								\item The measured value is sent to the data control department of the city 
								\end{itemize} } \\ \hline
		Sequence Description & \noindent\parbox[c]{\hsize}{ \begin{enumerate}
								\item Obtain measurement
								\item Check the network
								\item If network not available store data
								\item Send all data to the data control department of the city 
								\end{enumerate} } \\ \hline
		Exceptions           & \noindent\parbox[c]{\hsize}{In case of error, report to the data control department of the city} \\ \hline
	\end{tabu}
\end{table}

\newpage

\section{Request data}
\begin{figure}[!ht]
	\caption{Request Data}
	\label{fig:request_data}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.68\textwidth]{{"./img/Drawio/Use Cases/Request information case diagram"}.png}
\end{figure}

\begin{table}[!ht]
	\centering
	\caption{Request Data}
	\label{tab:request_data}
	\begin{tabu}{|l|X[l]|}
		\hline
		Scope and Objectives & \noindent\parbox[c]{\hsize}{The data collection centre have the possibility to request the information of the light and LED status of the motes and also the parameters that are using the motes. Furthermore, a ping functionality exists to check if the mote is alive.} \\ \hline
		Actors               & \noindent\parbox[c]{\hsize}{Data control department of the city}  \\ \hline
		Preconditions        & \noindent\parbox[c]{\hsize}{\begin{itemize}
				 \item The sensor nodes are on
				 \item The sensor node is online to get the request
			 \end{itemize} }   \\ \hline
		Post-conditions      & \noindent\parbox[c]{\hsize}{The measured value and statuses are sent to the data control department of the city} \\ \hline
		Sequence Description & \noindent\parbox[c]{\hsize}{\begin{enumerate}
				\item Check if node is online
				\item If not then repeat x times
				\item Request current data from node
			\end{enumerate}} \\ \hline
		Exceptions           & \noindent\parbox[c]{\hsize}{The sensor node does not respond after x requests}  \\ \hline
	\end{tabu}
\end{table}

\newpage

\section{Change parameters}
\begin{figure}[!ht]
	\caption{Change parameters}
	\label{fig:change_parameters}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Use Cases/Change parameters case diagram"}.png}
\end{figure}

\begin{table}[!ht]
	\centering
	\caption{Change parameters}
	\label{tab:change_parameters}
	\begin{tabu}{|l|X[l]|}
		\hline
		Scope and Objectives & \noindent\parbox[c]{\hsize}{The data collection center is able to change the threshold of the light sensor and also has the possibility of switch on/off the lights in case of emergency.}     \\ \hline
		Actors               & \noindent\parbox[c]{\hsize}{Data control department of the city}                                                                                                                               \\ \hline
		Preconditions        & \noindent\parbox[c]{\hsize}{\begin{itemize}\item The sensor nodes are on \item The sensor node is online to get the request \item Led light is working\end{itemize} }  \\ \hline
		Post-conditions      & \noindent\parbox[c]{\hsize}{\begin{itemize}\item The light is turned on/off \item Parameters are modified \item The status is sent to the data control department of the city\end{itemize}}  \\ \hline
		Sequence Description & \noindent\parbox[c]{\hsize}{\begin{enumerate}\item Check if node is online \item If not then repeat x times \item Request switching on/off the light or change of parameters \item Send ack when light turns on or parameters are changed \end{enumerate}} \\ \hline
		Exceptions           & \noindent\parbox[c]{\hsize}{\begin{itemize}\item The sensor node does not respond after x requests \item The light does not turn on/off\end{itemize}}         \\ \hline
	\end{tabu}
\end{table}

\chapter{Project Design}
\section{UML Component Diagrams}

\begin{figure}[!ht]
	\caption{Movement mote}
	\label{fig:movement_mote_component}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Components/Movement mote"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Light mote}
	\label{fig:light_mote_component}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Components/Light Mote"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Data collection centre}
	\label{fig:data_collection_centre_component}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Components/datacollection"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Aggregator}
	\label{fig:aggregator_component}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Components/Aggregator"}.png}
\end{figure}

\section{UML Class Diagrams}
\begin{figure}[!ht]
	\caption{Movement mote}
	\label{fig:movement_mote_class}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Class Diagrams/NormalSensor"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Light mote}
	\label{fig:light_mote_class}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Class Diagrams/LightSensor"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Sink}
	\label{fig:sink_class}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Class Diagrams/sink"}.png}
\end{figure}
\begin{figure}[!ht]
	\caption{Aggregator}
	\label{fig:aggregator_class}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.78\textwidth]{{"./img/Drawio/Class Diagrams/Aggregator"}.png}
\end{figure}

\section{Sequence Diagrams}
\begin{figure}[!ht]
	\caption{Light Broadcast}
	\label{fig:light_broadcast_sequence}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.98\textwidth]{{"./img/Drawio/Sequence Diagrams/LightBroadcast"}.png}
\end{figure}

\section{Protocol diagram}
\begin{figure}[!ht]
	\caption{Protocol diagram}
	\label{fig:protocol}
	\vspace{-1em}
	\centering
	\includegraphics[width=0.98\textwidth]{{"./img/Drawio/Protocol"}.png}
\end{figure}
\chapter{Testing}
\chapter{Conclusion}
In this project we created a smart lighting system which reacts dynamically on movement of vehicles or pedestrians and is also managed remotely. Operator can turn the lights on or off, check if the mote works, get current light intensity, change the threshold for night and day mode and also get the statistical data for use analysis.  

The system could be vastly improved by better motes which would not have to be wireless. The system might either be connected to metro-optical network or use power-line communication. 

\renewcommand{\acronymname}{List of acronyms}
\printglossaries



%\bibliographystyle{plain} 
\printbibliography
%%% Přílohy k bakalářské práci, existují-li (různé dodatky jako výpisy programů,
%%% diagramy apod.). Každá příloha musí být alespoň jednou odkazována z vlastního
%%% textu práce. Přílohy se číslují.
\openright
\end{document}